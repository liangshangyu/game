<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8" />
    <title>亲爱的，请用一笔画出图形</title>
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0, shrink-to-fit=no"
    />
    <link href="css/onstroke.css" rel="stylesheet" />
  </head>

  <body>
    <div class="wrapper">
      <div class="care">你呀，秋天到了，多喝水多加衣! 爱你~~</div>
      <!-- 关卡列表 -->
      <ul class="levels" id="levels">
        <!-- <li class="level">
				<span class="level-no">001</span>
				<span class="level-name">第一关</span>
				<div class="level-arrow"></div>
			</li> -->
      </ul>
      <div class="game" id="game">
        <div class="game-back" id="gameBack"></div>
        <canvas id="easel" width="375" height="603" class="easel"></canvas>
        <div class="game-control">
          <div class="game-control-reset">重新开始</div>
          <div class="game-control-rollback">回退</div>
        </div>
      </div>
    </div>
  </body>
  <script type="text/javascript" src="script/lib/pixi.js"></script>
  <script type="text/javascript" src="script/lib/gsap/TweenMax.js"></script>
  <script type="text/javascript" src="script/onestroke.js"></script>
  <script type="text/javascript">
    let onestroke = new OneStroke({
      // 默认的线段颜色与端点颜色
      lineColor: 0xe2e2e2,
      vertexColor: 0x6dc6c0,
      strokeColor: 0x416275,
      activeVertexColor: 0x6dc6c0,
      levels: [
        {
          lineColor: 13422809,
          vertexColor: 2600545,
          strokeColor: 1300272.5,
          activeVertexColor: 2600545,
          lines: [
            { x1: 368, y1: 148, x2: 68, y2: 560 },
            { x1: 368, y1: 148, x2: 668, y2: 560 },
            { x1: 68, y1: 336, x2: 368, y2: 336 },
            { x1: 68, y1: 336, x2: 68, y2: 560 },
            { x1: 368, y1: 336, x2: 668, y2: 336 },
            { x1: 368, y1: 336, x2: 68, y2: 560 },
            { x1: 368, y1: 336, x2: 668, y2: 560 },
            { x1: 668, y1: 336, x2: 668, y2: 560 },
            { x1: 68, y1: 560, x2: 668, y2: 560 },
            { x1: 68, y1: 560, x2: 68, y2: 784 },
            { x1: 68, y1: 560, x2: 368, y2: 784 },
            { x1: 68, y1: 560, x2: 368, y2: 1012 },
            { x1: 668, y1: 560, x2: 368, y2: 784 },
            { x1: 668, y1: 560, x2: 668, y2: 784 },
            { x1: 668, y1: 560, x2: 368, y2: 1012 },
            { x1: 68, y1: 784, x2: 368, y2: 784 },
            { x1: 368, y1: 784, x2: 668, y2: 784 },
          ],
          name: "5-1",
        },
        {
          lineColor: 13422809,
          vertexColor: 15423038,
          strokeColor: 7711519,
          activeVertexColor: 15423038,
          lines: [
            { x1: 64, y1: 212, x2: 364, y2: 212 },
            { x1: 64, y1: 212, x2: 288, y2: 436 },
            { x1: 64, y1: 212, x2: 176, y2: 700 },
            { x1: 64, y1: 212, x2: 64, y2: 888 },
            { x1: 364, y1: 212, x2: 668, y2: 212 },
            { x1: 364, y1: 212, x2: 288, y2: 436 },
            { x1: 364, y1: 212, x2: 440, y2: 436 },
            { x1: 668, y1: 212, x2: 440, y2: 436 },
            { x1: 668, y1: 212, x2: 552, y2: 700 },
            { x1: 668, y1: 212, x2: 668, y2: 888 },
            { x1: 288, y1: 436, x2: 364, y2: 888 },
            { x1: 440, y1: 436, x2: 364, y2: 888 },
            { x1: 176, y1: 700, x2: 364, y2: 888 },
            { x1: 552, y1: 700, x2: 364, y2: 888 },
            { x1: 64, y1: 888, x2: 364, y2: 888 },
            { x1: 364, y1: 888, x2: 668, y2: 888 },
          ],
          name: "5-2",
        },
        {
          lineColor: 13422809,
          vertexColor: 15772450,
          strokeColor: 7886225,
          activeVertexColor: 15772450,
          lines: [
            { x1: 368, y1: 156, x2: 68, y2: 344 },
            { x1: 368, y1: 156, x2: 668, y2: 344 },
            { x1: 368, y1: 156, x2: 220, y2: 568 },
            { x1: 368, y1: 156, x2: 516, y2: 568 },
            { x1: 68, y1: 344, x2: 220, y2: 568 },
            { x1: 68, y1: 344, x2: 516, y2: 568 },
            { x1: 68, y1: 344, x2: 68, y2: 752 },
            { x1: 668, y1: 344, x2: 220, y2: 568 },
            { x1: 668, y1: 344, x2: 516, y2: 568 },
            { x1: 668, y1: 344, x2: 668, y2: 752 },
            { x1: 220, y1: 568, x2: 68, y2: 752 },
            { x1: 220, y1: 568, x2: 668, y2: 752 },
            { x1: 220, y1: 568, x2: 368, y2: 1016 },
            { x1: 516, y1: 568, x2: 68, y2: 752 },
            { x1: 516, y1: 568, x2: 668, y2: 752 },
            { x1: 516, y1: 568, x2: 368, y2: 1016 },
            { x1: 68, y1: 752, x2: 368, y2: 1016 },
            { x1: 668, y1: 752, x2: 368, y2: 1016 },
          ],
          name: "5-3",
        },
        {
          lineColor: 13422809,
          vertexColor: 14242905,
          strokeColor: 7121452.5,
          activeVertexColor: 14242905,
          lines: [
            { x1: 180, y1: 172, x2: 368, y2: 324 },
            { x1: 180, y1: 172, x2: 368, y2: 736 },
            { x1: 556, y1: 172, x2: 368, y2: 324 },
            { x1: 556, y1: 172, x2: 368, y2: 736 },
            { x1: 368, y1: 324, x2: 68, y2: 360 },
            { x1: 368, y1: 324, x2: 668, y2: 360 },
            { x1: 68, y1: 360, x2: 180, y2: 624 },
            { x1: 668, y1: 360, x2: 556, y2: 624 },
            { x1: 180, y1: 624, x2: 368, y2: 736 },
            { x1: 180, y1: 624, x2: 256, y2: 848 },
            { x1: 180, y1: 624, x2: 68, y2: 1036 },
            { x1: 556, y1: 624, x2: 368, y2: 736 },
            { x1: 556, y1: 624, x2: 480, y2: 848 },
            { x1: 556, y1: 624, x2: 668, y2: 1036 },
            { x1: 256, y1: 848, x2: 68, y2: 1036 },
            { x1: 480, y1: 848, x2: 668, y2: 1036 },
          ],
          name: "5-4",
        },
        {
          lineColor: 13422809,
          vertexColor: 15292222,
          strokeColor: 7646111,
          activeVertexColor: 15292222,
          lines: [
            { x1: 64, y1: 188, x2: 252, y2: 188 },
            { x1: 64, y1: 188, x2: 64, y2: 452 },
            { x1: 252, y1: 188, x2: 480, y2: 976 },
            { x1: 480, y1: 188, x2: 668, y2: 188 },
            { x1: 480, y1: 188, x2: 64, y2: 452 },
            { x1: 480, y1: 188, x2: 668, y2: 716 },
            { x1: 480, y1: 188, x2: 252, y2: 976 },
            { x1: 668, y1: 188, x2: 668, y2: 452 },
            { x1: 64, y1: 452, x2: 252, y2: 976 },
            { x1: 668, y1: 452, x2: 64, y2: 716 },
            { x1: 64, y1: 716, x2: 64, y2: 976 },
            { x1: 668, y1: 716, x2: 252, y2: 976 },
            { x1: 668, y1: 716, x2: 668, y2: 976 },
            { x1: 64, y1: 976, x2: 252, y2: 976 },
            { x1: 480, y1: 976, x2: 668, y2: 976 },
          ],
          name: "5-5",
        },
        {
          lineColor: 13422809,
          vertexColor: 15292222,
          strokeColor: 7646111,
          activeVertexColor: 15292222,
          lines: [
            { x1: 68, y1: 152, x2: 180, y2: 300 },
            { x1: 68, y1: 152, x2: 68, y2: 524 },
            { x1: 368, y1: 152, x2: 180, y2: 300 },
            { x1: 368, y1: 152, x2: 556, y2: 300 },
            { x1: 368, y1: 152, x2: 180, y2: 824 },
            { x1: 368, y1: 152, x2: 556, y2: 824 },
            { x1: 668, y1: 152, x2: 556, y2: 300 },
            { x1: 668, y1: 152, x2: 668, y2: 524 },
            { x1: 180, y1: 300, x2: 556, y2: 300 },
            { x1: 180, y1: 300, x2: 368, y2: 524 },
            { x1: 556, y1: 300, x2: 368, y2: 524 },
            { x1: 68, y1: 524, x2: 368, y2: 784 },
            { x1: 668, y1: 524, x2: 368, y2: 784 },
            { x1: 180, y1: 824, x2: 368, y2: 1008 },
            { x1: 556, y1: 824, x2: 368, y2: 1008 },
          ],
          name: "5-6",
        },
        {
          lineColor: 13422809,
          vertexColor: 14242905,
          strokeColor: 7121452.5,
          activeVertexColor: 14242905,
          lines: [
            { x1: 368, y1: 148, x2: 180, y2: 296 },
            { x1: 368, y1: 148, x2: 556, y2: 296 },
            { x1: 180, y1: 296, x2: 556, y2: 296 },
            { x1: 180, y1: 296, x2: 368, y2: 408 },
            { x1: 180, y1: 296, x2: 68, y2: 524 },
            { x1: 556, y1: 296, x2: 368, y2: 408 },
            { x1: 556, y1: 296, x2: 668, y2: 524 },
            { x1: 368, y1: 408, x2: 68, y2: 524 },
            { x1: 368, y1: 408, x2: 668, y2: 524 },
            { x1: 68, y1: 524, x2: 668, y2: 524 },
            { x1: 68, y1: 524, x2: 368, y2: 672 },
            { x1: 668, y1: 524, x2: 368, y2: 672 },
            { x1: 368, y1: 672, x2: 220, y2: 784 },
            { x1: 368, y1: 672, x2: 516, y2: 784 },
            { x1: 220, y1: 784, x2: 516, y2: 784 },
            { x1: 220, y1: 784, x2: 368, y2: 1008 },
            { x1: 516, y1: 784, x2: 368, y2: 1008 },
          ],
          name: "5-7",
        },
        {
          lineColor: 13422809,
          vertexColor: 10115509,
          strokeColor: 5057754.5,
          activeVertexColor: 10115509,
          lines: [
            { x1: 368, y1: 156, x2: 68, y2: 308 },
            { x1: 368, y1: 156, x2: 668, y2: 308 },
            { x1: 368, y1: 156, x2: 368, y2: 420 },
            { x1: 68, y1: 308, x2: 368, y2: 420 },
            { x1: 68, y1: 308, x2: 368, y2: 568 },
            { x1: 68, y1: 308, x2: 68, y2: 832 },
            { x1: 668, y1: 308, x2: 368, y2: 420 },
            { x1: 668, y1: 308, x2: 368, y2: 568 },
            { x1: 668, y1: 308, x2: 668, y2: 828 },
            { x1: 368, y1: 420, x2: 368, y2: 568 },
            { x1: 368, y1: 568, x2: 368, y2: 716 },
            { x1: 368, y1: 568, x2: 68, y2: 832 },
            { x1: 368, y1: 568, x2: 668, y2: 828 },
            { x1: 368, y1: 716, x2: 68, y2: 832 },
            { x1: 368, y1: 716, x2: 668, y2: 828 },
            { x1: 368, y1: 716, x2: 368, y2: 1016 },
            { x1: 68, y1: 832, x2: 368, y2: 1016 },
            { x1: 668, y1: 828, x2: 368, y2: 1016 },
          ],
          name: "5-8",
        },
        {
          lineColor: 13422809,
          vertexColor: 1817755,
          strokeColor: 908877.5,
          activeVertexColor: 1817755,
          lines: [
            { x1: 68, y1: 176, x2: 368, y2: 252 },
            { x1: 68, y1: 176, x2: 368, y2: 440 },
            { x1: 668, y1: 176, x2: 368, y2: 252 },
            { x1: 668, y1: 176, x2: 368, y2: 440 },
            { x1: 180, y1: 404, x2: 68, y2: 440 },
            { x1: 180, y1: 404, x2: 368, y2: 776 },
            { x1: 556, y1: 404, x2: 668, y2: 440 },
            { x1: 556, y1: 404, x2: 368, y2: 776 },
            { x1: 68, y1: 440, x2: 104, y2: 628 },
            { x1: 368, y1: 440, x2: 104, y2: 628 },
            { x1: 368, y1: 440, x2: 628, y2: 628 },
            { x1: 668, y1: 440, x2: 628, y2: 628 },
            { x1: 104, y1: 628, x2: 368, y2: 776 },
            { x1: 104, y1: 628, x2: 368, y2: 964 },
            { x1: 628, y1: 628, x2: 368, y2: 776 },
            { x1: 628, y1: 628, x2: 368, y2: 964 },
          ],
          name: "5-9",
        },
      ],
    });

    // 兼容大屏幕适配
    function fitEaselInfo() {
      onestroke.viewLeft = document
        .querySelector(".wrapper")
        .getBoundingClientRect().left;
      onestroke.ratio = 375 / Math.min(document.body.clientWidth, 540);
    }
    window.addEventListener("resize", fitEaselInfo);

    fitEaselInfo();

    // 通关
    onestroke.event.on("pass", function () {
      console.log("通关");
      // 进入下一关
      onestroke.next();
    });

    // 进入新的一关
    onestroke.event.on("start", function (curLevel) {
      gameBack.innerHTML = curLevel.name;
    });

    // gameover
    onestroke.event.on("gameover", function () {
      alert("恭喜宝宝，通关了");
    });

    // 关卡加载中
    onestroke.event.on("level-loading", function () {
      console.log("关卡" + onestroke.curLevel + " 加载中...");
    });

    onestroke.event.on("level-loaded", function () {
      console.log("关卡" + onestroke.curLevel + " 加载成功");
    });

    // showOneStroke
    let showOneStroke = function () {
      levels.style.transform = game.style.transform = "translate(-100%, 0)";
    };

    // hideOneStroke
    let hideOneStroke = function () {
      levels.style.transform = game.style.transform = "translate(0, 0)";
    };

    // 进入对应的关卡
    let enter = function (index) {
      showOneStroke();
      onestroke.enter(index);
    };

    // 关卡列表初始化
    let initLevels = function () {
      let str = "";
      onestroke.config.levels.forEach(function (level, index) {
        str +=
          '<li class="level" onclick="enter(' +
          index +
          ')">\
				<span class="level-no">' +
          (index + 1) +
          '</span>\
				<span class="level-name">' +
          level.name +
          '</span>\
				<div class="level-arrow"></div>\
			</li>';
      });
      levels.innerHTML = str;
      // 返回事件
      gameBack.addEventListener("click", function () {
        hideOneStroke();
      });
      // 重新开始
      document
        .querySelector(".game-control-reset")
        .addEventListener("click", function () {
          onestroke.restart();
        });
      // 回退
      document
        .querySelector(".game-control-rollback")
        .addEventListener("click", function () {
          onestroke.rollback();
        });
    };
    // 调用初始化列表
    initLevels();
  </script>
</html>
