<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8" />
    <title>亲爱的，请用一笔画出图形</title>
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0, shrink-to-fit=no"
    />
    <link href="css/onstroke.css" rel="stylesheet" />
  </head>

  <body>
    <div class="wrapper">
      <!-- 关卡列表 -->
      <ul class="levels" id="levels">
        <!-- <li class="level">
				<span class="level-no">001</span>
				<span class="level-name">第一关</span>
				<div class="level-arrow"></div>
			</li> -->
      </ul>
      <div class="game" id="game">
        <div class="game-back" id="gameBack"></div>
        <canvas id="easel" width="375" height="603" class="easel"></canvas>
        <div class="game-control">
          <div class="game-control-reset">重新开始</div>
          <div class="game-control-rollback">回退</div>
        </div>
      </div>
    </div>
  </body>
  <script type="text/javascript" src="script/lib/pixi.js"></script>
  <script type="text/javascript" src="script/lib/gsap/TweenMax.js"></script>
  <script type="text/javascript" src="script/onestroke.js"></script>
  <script type="text/javascript">
    let onestroke = new OneStroke({
      // 默认的线段颜色与端点颜色
      lineColor: 0xe2e2e2,
      vertexColor: 0x6dc6c0,
      strokeColor: 0x416275,
      activeVertexColor: 0x6dc6c0,
      levels: [
        {
          name: "第一关",
          lineColor: 0xe2e2e2,
          vertexColor: 0x90b34f,
          strokeColor: 0x445624,
          activeVertexColor: 0x90b34f,
          lines: [
            { x1: 375, y1: 366, x2: 200, y2: 916 },
            { x1: 200, y1: 916, x2: 664, y2: 576 },
            { x1: 664, y1: 576, x2: 88, y2: 576 },
            { x1: 88, y1: 576, x2: 556, y2: 916 },
            { x1: 556, y1: 916, x2: 375, y2: 366 },
          ],
        },
        {
          name: "第二关",
          lineColor: 0xe2e2e2,
          vertexColor: 0x6dc6c0,
          strokeColor: 0x416275,
          activeVertexColor: 0x6dc6c0,
          lines: [
            { x1: 240, y1: 460, x2: 654, y2: 875 },
            { x1: 654, y1: 875, x2: 100, y2: 740 },
            { x1: 100, y1: 740, x2: 240, y2: 460 },
            { x1: 240, y1: 460, x2: 515, y2: 460 },
            { x1: 515, y1: 460, x2: 654, y2: 740 },
            { x1: 654, y1: 740, x2: 100, y2: 875 },
            { x1: 100, y1: 875, x2: 515, y2: 460 },
          ],
        },
        {
          name: "第三关",
          lineColor: 0xe2e2e2,
          vertexColor: 0xec6a74,
          strokeColor: 0x914748,
          activeVertexColor: 0xec6a74,
          lines: [
            { x1: 177, y1: 367, x2: 177, y2: 961 },
            { x1: 177, y1: 961, x2: 673, y2: 861 },
            { x1: 673, y1: 861, x2: 177, y2: 367 },
            { x1: 177, y1: 367, x2: 572, y2: 367 },
            { x1: 572, y1: 367, x2: 78, y2: 861 },
            { x1: 78, y1: 861, x2: 572, y2: 961 },
            { x1: 572, y1: 961, x2: 572, y2: 367 },
          ],
        },
        {
          name: "第四关",
          src: "images/049.jpeg",
        },
        {
          name: "第五关",
          lineColor: 0xe2e2e2,
          vertexColor: 0xec6a74,
          strokeColor: 0x914748,
          activeVertexColor: 0xec6a74,

          lines: [
            { x1: 240, y1: 236, x2: 496, y2: 236 },
            { x1: 240, y1: 236, x2: 240, y2: 980 },
            { x1: 496, y1: 236, x2: 668, y2: 236 },
            { x1: 668, y1: 236, x2: 68, y2: 668 },
            { x1: 668, y1: 236, x2: 668, y2: 980 },
            { x1: 68, y1: 668, x2: 668, y2: 980 },
            { x1: 240, y1: 980, x2: 496, y2: 980 },
            { x1: 496, y1: 980, x2: 668, y2: 980 },
          ],
        },
        {
          name: "第六关",
          src: "images/059.jpeg",
        },
        {
          name: "第七关",
          src: "images/401.jpeg",
        },
        {
          name: "第八关",
          src: "images/08.jpg",
        },
        {
          name: "第九关",
          src: "images/09.jpg",
        },
        {
          name: "第十关",
          src: "images/10.jpg",
        },
        {
          name: "第十一关",
          src: "images/11.jpg",
        },
        {
          name: "第十二关",
          src: "images/12.jpg",
        },
        {
          name: "第十三关",
          src: "images/13.jpg",
        },
        {
          name: "第十四关",
          lineColor: 13422811,
          vertexColor: 1817755,
          strokeColor: 908877.5,
          activeVertexColor: 1817755,
          lines: [
            { x1: 368, y1: 152, x2: 68, y2: 340 },
            { x1: 368, y1: 152, x2: 668, y2: 340 },
            { x1: 368, y1: 152, x2: 68, y2: 788 },
            { x1: 368, y1: 152, x2: 668, y2: 788 },
            { x1: 68, y1: 340, x2: 68, y2: 788 },
            { x1: 668, y1: 340, x2: 668, y2: 788 },
            { x1: 368, y1: 564, x2: 68, y2: 788 },
            { x1: 368, y1: 564, x2: 668, y2: 788 },
            { x1: 68, y1: 788, x2: 668, y2: 788 },
            { x1: 68, y1: 788, x2: 368, y2: 1012 },
            { x1: 668, y1: 788, x2: 368, y2: 1012 },
          ],
        },
        {
          lineColor: 13422811,
          vertexColor: 1817755,
          strokeColor: 908877.5,
          activeVertexColor: 1817755,
          lines: [
            { x1: 256, y1: 152, x2: 144, y2: 336 },
            { x1: 256, y1: 152, x2: 368, y2: 488 },
            { x1: 444, y1: 152, x2: 592, y2: 336 },
            { x1: 444, y1: 152, x2: 368, y2: 488 },
            { x1: 144, y1: 336, x2: 368, y2: 488 },
            { x1: 144, y1: 336, x2: 68, y2: 560 },
            { x1: 144, y1: 336, x2: 368, y2: 824 },
            { x1: 592, y1: 336, x2: 368, y2: 488 },
            { x1: 592, y1: 336, x2: 668, y2: 560 },
            { x1: 592, y1: 336, x2: 368, y2: 824 },
            { x1: 668, y1: 560, x2: 368, y2: 1008 },
            { x1: 68, y1: 560, x2: 368, y2: 1008 },
          ],
          name: "2-1",
        },
        {
          lineColor: 13422811,
          vertexColor: 1817755,
          strokeColor: 908877.5,
          activeVertexColor: 1817755,
          lines: [
            { x1: 276, y1: 180, x2: 648, y2: 180 },
            { x1: 276, y1: 180, x2: 88, y2: 404 },
            { x1: 276, y1: 180, x2: 460, y2: 404 },
            { x1: 276, y1: 180, x2: 276, y2: 664 },
            { x1: 648, y1: 180, x2: 460, y2: 404 },
            { x1: 648, y1: 180, x2: 648, y2: 664 },
            { x1: 88, y1: 404, x2: 276, y2: 664 },
            { x1: 460, y1: 404, x2: 276, y2: 664 },
            { x1: 460, y1: 404, x2: 648, y2: 664 },
            { x1: 276, y1: 664, x2: 648, y2: 664 },
            { x1: 276, y1: 664, x2: 88, y2: 1000 },
            { x1: 276, y1: 664, x2: 464, y2: 1000 },
            { x1: 648, y1: 664, x2: 464, y2: 1000 },
            { x1: 648, y1: 664, x2: 648, y2: 1000 },
            { x1: 88, y1: 1000, x2: 464, y2: 1000 },
            { x1: 464, y1: 1000, x2: 648, y2: 1000 },
          ],
          name: "2-2",
        },
        {
          lineColor: 13422811,
          vertexColor: 2731361,
          strokeColor: 1365680.5,
          activeVertexColor: 2731361,
          lines: [
            { x1: 68, y1: 180, x2: 372, y2: 364 },
            { x1: 68, y1: 180, x2: 144, y2: 552 },
            { x1: 672, y1: 176, x2: 372, y2: 364 },
            { x1: 672, y1: 176, x2: 596, y2: 552 },
            { x1: 144, y1: 552, x2: 372, y2: 740 },
            { x1: 144, y1: 552, x2: 72, y2: 892 },
            { x1: 144, y1: 552, x2: 372, y2: 1004 },
            { x1: 596, y1: 552, x2: 372, y2: 740 },
            { x1: 596, y1: 552, x2: 672, y2: 892 },
            { x1: 596, y1: 552, x2: 372, y2: 1004 },
            { x1: 72, y1: 892, x2: 372, y2: 1004 },
            { x1: 672, y1: 892, x2: 372, y2: 1004 },
          ],
          name: "2-3",
        },
        {
          lineColor: 13422811,
          vertexColor: 5334434,
          strokeColor: 2667217,
          activeVertexColor: 5334434,
          lines: [
            { x1: 220, y1: 260, x2: 516, y2: 260 },
            { x1: 220, y1: 260, x2: 68, y2: 560 },
            { x1: 220, y1: 260, x2: 368, y2: 560 },
            { x1: 220, y1: 260, x2: 668, y2: 560 },
            { x1: 516, y1: 260, x2: 368, y2: 560 },
            { x1: 516, y1: 260, x2: 668, y2: 560 },
            { x1: 68, y1: 560, x2: 368, y2: 560 },
            { x1: 68, y1: 560, x2: 220, y2: 860 },
            { x1: 68, y1: 560, x2: 516, y2: 860 },
            { x1: 368, y1: 560, x2: 668, y2: 560 },
            { x1: 368, y1: 560, x2: 220, y2: 860 },
            { x1: 368, y1: 560, x2: 516, y2: 860 },
            { x1: 668, y1: 560, x2: 516, y2: 860 },
            { x1: 220, y1: 860, x2: 516, y2: 860 },
          ],
          name: "2-4",
        },
        {
          lineColor: 13422811,
          vertexColor: 14242903,
          strokeColor: 7121451.5,
          activeVertexColor: 14242903,
          lines: [
            { x1: 68, y1: 144, x2: 368, y2: 696 },
            { x1: 68, y1: 144, x2: 368, y2: 144 },
            { x1: 368, y1: 144, x2: 668, y2: 144 },
            { x1: 368, y1: 144, x2: 668, y2: 960 },
            { x1: 368, y1: 144, x2: 68, y2: 960 },
            { x1: 668, y1: 144, x2: 368, y2: 696 },
            { x1: 368, y1: 360, x2: 68, y2: 508 },
            { x1: 368, y1: 360, x2: 668, y2: 508 },
            { x1: 68, y1: 508, x2: 368, y2: 696 },
            { x1: 668, y1: 508, x2: 368, y2: 696 },
            { x1: 368, y1: 696, x2: 68, y2: 960 },
            { x1: 368, y1: 696, x2: 668, y2: 960 },
            { x1: 68, y1: 960, x2: 668, y2: 960 },
          ],
          name: "2-5",
        },
        {
          lineColor: 13422811,
          vertexColor: 4884953,
          strokeColor: 2442476.5,
          activeVertexColor: 4884953,
          lines: [
            { x1: 220, y1: 196, x2: 516, y2: 196 },
            { x1: 220, y1: 196, x2: 220, y2: 608 },
            { x1: 220, y1: 196, x2: 516, y2: 608 },
            { x1: 516, y1: 196, x2: 220, y2: 608 },
            { x1: 516, y1: 196, x2: 516, y2: 608 },
            { x1: 68, y1: 608, x2: 220, y2: 608 },
            { x1: 68, y1: 608, x2: 68, y2: 944 },
            { x1: 220, y1: 608, x2: 368, y2: 608 },
            { x1: 368, y1: 608, x2: 516, y2: 608 },
            { x1: 368, y1: 608, x2: 68, y2: 944 },
            { x1: 368, y1: 608, x2: 668, y2: 944 },
            { x1: 516, y1: 608, x2: 668, y2: 608 },
            { x1: 668, y1: 608, x2: 668, y2: 944 },
          ],
          name: "3-1",
        },
        {
          lineColor: 13422811,
          vertexColor: 15423038,
          strokeColor: 7711519,
          activeVertexColor: 15423038,
          lines: [
            { x1: 148, y1: 164, x2: 604, y2: 164 },
            { x1: 148, y1: 164, x2: 376, y2: 392 },
            { x1: 148, y1: 164, x2: 72, y2: 584 },
            { x1: 148, y1: 164, x2: 260, y2: 1004 },
            { x1: 604, y1: 164, x2: 376, y2: 392 },
            { x1: 604, y1: 164, x2: 680, y2: 584 },
            { x1: 604, y1: 164, x2: 488, y2: 1004 },
            { x1: 376, y1: 392, x2: 72, y2: 584 },
            { x1: 376, y1: 392, x2: 680, y2: 584 },
            { x1: 72, y1: 584, x2: 260, y2: 1004 },
            { x1: 680, y1: 584, x2: 488, y2: 1004 },
            { x1: 376, y1: 700, x2: 260, y2: 1004 },
            { x1: 376, y1: 700, x2: 488, y2: 1004 },
            { x1: 260, y1: 1004, x2: 488, y2: 1004 },
          ],
          name: "3-2",
        },
        {
          lineColor: 13422811,
          vertexColor: 8807644,
          strokeColor: 4403822,
          activeVertexColor: 8807644,
          lines: [
            { x1: 56, y1: 184, x2: 360, y2: 336 },
            { x1: 56, y1: 184, x2: 56, y2: 568 },
            { x1: 668, y1: 184, x2: 360, y2: 336 },
            { x1: 668, y1: 184, x2: 668, y2: 568 },
            { x1: 360, y1: 336, x2: 56, y2: 568 },
            { x1: 360, y1: 336, x2: 668, y2: 568 },
            { x1: 360, y1: 336, x2: 132, y2: 796 },
            { x1: 360, y1: 336, x2: 588, y2: 796 },
            { x1: 360, y1: 336, x2: 284, y2: 948 },
            { x1: 360, y1: 336, x2: 436, y2: 948 },
            { x1: 132, y1: 796, x2: 588, y2: 796 },
          ],
          name: "3-3",
        },
        {
          lineColor: 13422811,
          vertexColor: 4042458,
          strokeColor: 2021229,
          activeVertexColor: 4042458,
          lines: [
            { x1: 220, y1: 172, x2: 68, y2: 324 },
            { x1: 220, y1: 172, x2: 368, y2: 324 },
            { x1: 520, y1: 172, x2: 368, y2: 324 },
            { x1: 520, y1: 172, x2: 668, y2: 324 },
            { x1: 68, y1: 324, x2: 368, y2: 324 },
            { x1: 68, y1: 324, x2: 180, y2: 436 },
            { x1: 68, y1: 324, x2: 68, y2: 624 },
            { x1: 368, y1: 324, x2: 668, y2: 324 },
            { x1: 368, y1: 324, x2: 180, y2: 772 },
            { x1: 368, y1: 324, x2: 556, y2: 772 },
            { x1: 668, y1: 324, x2: 556, y2: 436 },
            { x1: 668, y1: 324, x2: 668, y2: 624 },
            { x1: 180, y1: 436, x2: 556, y2: 436 },
            { x1: 180, y1: 436, x2: 180, y2: 772 },
            { x1: 556, y1: 436, x2: 180, y2: 772 },
            { x1: 556, y1: 436, x2: 556, y2: 772 },
            { x1: 68, y1: 624, x2: 180, y2: 772 },
            { x1: 668, y1: 624, x2: 556, y2: 772 },
            { x1: 180, y1: 772, x2: 556, y2: 772 },
            { x1: 180, y1: 772, x2: 368, y2: 920 },
            { x1: 556, y1: 772, x2: 368, y2: 920 },
          ],
          name: "3-4",
        },
        {
          lineColor: 13422811,
          vertexColor: 14242903,
          strokeColor: 7121451.5,
          activeVertexColor: 14242903,
          lines: [
            { x1: 208, y1: 144, x2: 56, y2: 708 },
            { x1: 208, y1: 144, x2: 360, y2: 516 },
            { x1: 512, y1: 144, x2: 668, y2: 708 },
            { x1: 512, y1: 144, x2: 360, y2: 516 },
            { x1: 56, y1: 364, x2: 668, y2: 364 },
            { x1: 56, y1: 364, x2: 208, y2: 708 },
            { x1: 668, y1: 364, x2: 512, y2: 708 },
            { x1: 360, y1: 516, x2: 208, y2: 708 },
            { x1: 360, y1: 516, x2: 512, y2: 708 },
            { x1: 56, y1: 708, x2: 360, y2: 1012 },
            { x1: 208, y1: 708, x2: 360, y2: 1012 },
            { x1: 512, y1: 708, x2: 360, y2: 1012 },
            { x1: 668, y1: 708, x2: 360, y2: 1012 },
          ],
          name: "3-5",
        },
        {
          lineColor: 13422811,
          vertexColor: 4042458,
          strokeColor: 2021229,
          activeVertexColor: 4042458,
          lines: [
            { x1: 180, y1: 156, x2: 556, y2: 156 },
            { x1: 180, y1: 156, x2: 368, y2: 644 },
            { x1: 556, y1: 156, x2: 368, y2: 644 },
            { x1: 368, y1: 416, x2: 668, y2: 416 },
            { x1: 368, y1: 416, x2: 368, y2: 644 },
            { x1: 668, y1: 416, x2: 668, y2: 644 },
            { x1: 368, y1: 644, x2: 668, y2: 644 },
            { x1: 368, y1: 644, x2: 368, y2: 828 },
            { x1: 668, y1: 644, x2: 368, y2: 828 },
            { x1: 68, y1: 828, x2: 368, y2: 828 },
            { x1: 68, y1: 828, x2: 68, y2: 1016 },
            { x1: 368, y1: 828, x2: 368, y2: 1016 },
            { x1: 68, y1: 1016, x2: 368, y2: 1016 },
          ],
          name: "3-6",
        },
        {
          lineColor: 13422811,
          vertexColor: 4042458,
          strokeColor: 2021229,
          activeVertexColor: 4042458,
          lines: [
            { x1: 60, y1: 220, x2: 364, y2: 220 },
            { x1: 60, y1: 220, x2: 364, y2: 520 },
            { x1: 364, y1: 220, x2: 668, y2: 220 },
            { x1: 364, y1: 220, x2: 64, y2: 520 },
            { x1: 364, y1: 220, x2: 668, y2: 520 },
            { x1: 668, y1: 220, x2: 668, y2: 520 },
            { x1: 64, y1: 520, x2: 364, y2: 520 },
            { x1: 64, y1: 520, x2: 64, y2: 900 },
            { x1: 64, y1: 520, x2: 364, y2: 896 },
            { x1: 364, y1: 520, x2: 668, y2: 520 },
            { x1: 364, y1: 520, x2: 668, y2: 900 },
            { x1: 668, y1: 520, x2: 364, y2: 896 },
            { x1: 64, y1: 900, x2: 364, y2: 896 },
            { x1: 364, y1: 896, x2: 668, y2: 900 },
          ],
          name: "3-7",
        },
      ],
    });

    // 兼容大屏幕适配
    function fitEaselInfo() {
      onestroke.viewLeft = document
        .querySelector(".wrapper")
        .getBoundingClientRect().left;
      onestroke.ratio = 375 / Math.min(document.body.clientWidth, 540);
    }
    window.addEventListener("resize", fitEaselInfo);

    fitEaselInfo();

    // 通关
    onestroke.event.on("pass", function () {
      console.log("通关");
      // 进入下一关
      onestroke.next();
    });

    // 进入新的一关
    onestroke.event.on("start", function (curLevel) {
      gameBack.innerHTML = curLevel.name;
    });

    // gameover
    onestroke.event.on("gameover", function () {
      alert("恭喜宝宝，通关了");
    });

    // 关卡加载中
    onestroke.event.on("level-loading", function () {
      console.log("关卡" + onestroke.curLevel + " 加载中...");
    });

    onestroke.event.on("level-loaded", function () {
      console.log("关卡" + onestroke.curLevel + " 加载成功");
    });

    // showOneStroke
    let showOneStroke = function () {
      levels.style.transform = game.style.transform = "translate(-100%, 0)";
    };

    // hideOneStroke
    let hideOneStroke = function () {
      levels.style.transform = game.style.transform = "translate(0, 0)";
    };

    // 进入对应的关卡
    let enter = function (index) {
      showOneStroke();
      onestroke.enter(index);
    };

    // 关卡列表初始化
    let initLevels = function () {
      let str = "";
      onestroke.config.levels.forEach(function (level, index) {
        str +=
          '<li class="level" onclick="enter(' +
          index +
          ')">\
				<span class="level-no">' +
          (index + 1) +
          '</span>\
				<span class="level-name">' +
          level.name +
          '</span>\
				<div class="level-arrow"></div>\
			</li>';
      });
      levels.innerHTML = str;
      // 返回事件
      gameBack.addEventListener("click", function () {
        hideOneStroke();
      });
      // 重新开始
      document
        .querySelector(".game-control-reset")
        .addEventListener("click", function () {
          onestroke.restart();
        });
      // 回退
      document
        .querySelector(".game-control-rollback")
        .addEventListener("click", function () {
          onestroke.rollback();
        });
    };
    // 调用初始化列表
    initLevels();
  </script>
</html>
